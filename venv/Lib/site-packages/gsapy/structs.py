from comtypes.automation import _midlSAFEARRAY
from ctypes import c_double
import importlib

class structs():
    is_init = True
    struct_module = None

    @staticmethod
    def initialize(gsa_module):
        structs.struct_module = importlib.import_module(gsa_module)
        structs.is_init = True
    
    @staticmethod
    def view_orientation_struct(latitude, longitude, eye_distance, object_point, mid_point, picture_rotation):
        if structs.is_init:
            struct = structs.struct_module.GsaViewOrientation()
            struct.Latitude = latitude
            struct.Longitude = longitude
            struct.EyeDistance = eye_distance
            struct.ObjectPoint = _midlSAFEARRAY(c_double).from_param(object_point)
            struct.MidPoint = _midlSAFEARRAY(c_double).from_param(mid_point)
            struct.PictureRotation = picture_rotation
            return struct
        else:
            return None